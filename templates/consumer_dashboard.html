{% extends "base.html" %}
{% block title %}My Bills{% endblock %}

{% block content %}
<div style="margin-top: 2rem;">
    <h1>Welcome, {{ user.username }}</h1>
    <p>Meter: <strong>{{ user.meter_number }}</strong> | Type: <strong>{{ user.connection_type }}</strong></p>

    <h3>Your Bills</h3>
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Prev Read</th>
                    <th>Curr Read</th>
                    <th>Units</th>
                    <th>Amount</th>
                    <th>Due Date</th>
                    <th>Status</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for bill in bills %}
                <tr>
                    <td>{{ bill.bill_date.strftime('%Y-%m-%d') }}</td>
                    <td>{{ bill.previous_reading }}</td>
                    <td>{{ bill.current_reading }}</td>
                    <td>{{ bill.units_consumed }}</td>
                    <td style="font-weight:bold;">Rs {{ "%.2f"|format(bill.total_amount) }}</td>
                    <td>{{ bill.due_date.strftime('%Y-%m-%d') }}</td>
                    <td>
                        <span class="badge {% if bill.status == 'Paid' %}badge-paid{% else %}badge-pending{% endif %}">
                            {{ bill.status }}
                        </span>
                    </td>
                    <td>
                        {% if bill.status == 'Unpaid' %}
                        <a href="{{ url_for('consumer.pay_bill', bill_id=bill.id) }}" class="btn btn-primary"
                            style="padding: 0.2rem 0.8rem; font-size: 0.9rem;">Pay Now</a>
                        {% else %}
                        <span style="color: green;">âœ“ Paid</span>
                        {% endif %}
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="8">No bills found.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}